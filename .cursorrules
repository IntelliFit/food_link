# Food Link 项目开发规则

## 📝 自动记录进度（重要！）
**每次进行代码修改、bug 修复、功能添加时，必须自动更新 PROGRESS.md 文件**

### 更新格式（简洁的 Git commit 风格）
在 PROGRESS.md 文件顶部（日期标题下）添加一行简洁的记录：

```markdown
- [图标] [类型]: [简要描述（1-2句话）] [涉及文件]
```

### 图标和类型对照
- 🐛 fix: Bug修复
- ✨ feat: 新功能
- 🔧 refactor: 重构/优化
- 📝 docs: 文档更新
- 🎨 style: UI改进
- 🔒 security: 安全修复
- ⚡ perf: 性能优化
- 🗃️ db: 数据库变更
- 🔧 chore: 构建/配置

### 示例
```markdown
## 2025-01-28

- 🐛 fix: 修复登录按钮无响应问题，添加错误提示 `src/pages/profile/index.tsx`
- ✨ feat: 添加食物收藏功能，支持快速添加到记录 `src/pages/favorites/index.tsx`
- 📝 docs: 更新API文档，添加认证说明 `README.md`
- ⚡ perf: 优化图片上传，添加压缩逻辑减少50%大小 `src/utils/api.ts`
```

**要求：**
- 每条记录控制在 1-2 句话
- 说明做了什么，不需要详细技术细节
- 文件路径用反引号包裹
- 保持简洁清晰

---

## 🎯 代码规范

### TypeScript
- 使用严格模式
- 所有函数必须有类型注解
- 避免使用 `any`，优先使用具体类型或 `unknown`
- 接口命名使用 PascalCase

### React
- 使用函数式组件 + Hooks
- 组件文件名使用 PascalCase
- Props 接口命名：`[ComponentName]Props`
- 状态管理优先使用 `useState` 和 `useEffect`

### 命名规范
- 变量/函数：camelCase（驼峰）
- 组件/类/接口：PascalCase（帕斯卡）
- 常量：UPPER_SNAKE_CASE（大写下划线）
- 文件名：kebab-case 或 PascalCase

### 注释
- 注释使用中文
- 代码使用英文
- 复杂逻辑必须添加注释
- 函数添加 JSDoc 注释

---

## 🏗️ 项目特定规则

### API 调用
- 统一使用 `src/utils/api.ts` 中的封装函数
- 所有请求必须有超时设置
- 必须处理错误情况
- 使用 `Taro.showLoading()` 显示加载状态

### 用户体验
- 所有用户操作必须有反馈（Toast/Modal）
- 加载状态必须显示
- 错误信息必须友好且具体
- 按钮点击后防止重复提交

### 数据处理
- 营养数据保留一位小数
- 重量单位统一使用克（g）
- 热量单位统一使用千卡（kcal）
- 图片处理使用 Base64 编码

### 错误处理
- 使用 try-catch 包裹异步操作
- 错误信息记录到控制台
- 向用户显示友好的错误提示
- 网络错误提示"请检查网络连接"

---

## 📦 提交信息格式

遵循 Conventional Commits 规范：

- `feat`: 新功能
- `fix`: Bug修复
- `docs`: 文档更新
- `style`: 代码格式调整（不影响功能）
- `refactor`: 重构（不是新功能也不是修复）
- `perf`: 性能优化
- `test`: 测试相关
- `chore`: 构建/工具相关

示例：
```
feat: 添加食物收藏功能
fix: 修复重量调节bug
docs: 更新API文档
```

---

## 🔍 代码审查清单

提交代码前检查：
- [ ] 代码符合规范
- [ ] 已添加必要注释
- [ ] 已处理错误情况
- [ ] 已测试主要功能
- [ ] 已更新 PROGRESS.md
- [ ] 无 console.log 调试代码
- [ ] 无未使用的导入

---

## 🚀 性能优化原则

- 避免不必要的重渲染
- 使用 `useMemo` 和 `useCallback` 优化
- 图片懒加载
- 列表使用虚拟滚动（长列表）
- 防抖和节流处理频繁操作

---

## 🔐 安全原则

- 不在代码中硬编码密钥
- 使用环境变量存储敏感信息
- Token 存储在本地安全存储
- API 请求使用 HTTPS
- 用户输入必须验证和清理

---

**最后更新：** 2025-01-28

